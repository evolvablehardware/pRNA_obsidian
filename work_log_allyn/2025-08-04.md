## Log
### Debugging the Memory Controller
Tested all the pico1/pico2 and explicit/implicit BRAM again to make sure I was getting consistent bugs. 

Double checked all the FPGA and Pico pins were correct.
- [pico pinout](https://pico-ice.tinyvision.ai/md_pinout.html)
- [pico 2 pinout](https://pico2-ice.tinyvision.ai/md_pinout.html)
- [pico fpga pins](https://github.com/tinyvision-ai-inc/pico-ice-sdk/blob/main/rtl/pico_ice.pcf)
- [pico2 fpga pins](https://github.com/tinyvision-ai-inc/pico-ice-sdk/blob/main/rtl/pico2_ice.pcf)
- [rp2350 datasheet](https://datasheets.raspberrypi.com/rp2350/rp2350-datasheet.pdf#io_function_select) to make sure I'm using the right UART instance)

I sent this message to the devs:
>Hi, I am working on a project that involves sending data back and forth from a host PC and the FPGA using uart. I have my project working on the pico-ice, but not on the pico2-ice. It seems that the first bit of the first byte I'm sending in every chunk of data is always received as 0 on the pico2. My C code sets up the UART, programs the FPGA, and sends a reset signal for the state machine on the FPGA. It uses code from these examples: https://github.com/tinyvision-ai-inc/pico-ice-sdk/tree/main/examples/rp2_usb_uart and https://github.com/tinyvision-ai-inc/pico-ice-sdk/blob/main/examples/rp2_ice_blinky/main.c
>
>The only things that change between the designs for the pico and pico2 are the pcf file used, the pins numbers for UART and the reset signal in the C code, and of course the cmake flag to build for the pico2. I've doubled checked I have all the pins correct, and I don't think there's a problem there, since everything seems to be received correctly except for the first bit. Any ideas what could be causing this discrepancy?

The devs suggested I get a simpler demo working, such as jumping the TX and RX pins together and not even using pins connected to the FPGA. Before I tried that, I went back to my [demo](https://github.com/evolvablehardware/BitstreamEvolutionPico/tree/main/exampleProjectsC/rp2_ice_echo) where the FPGA does: `assign UART_TX = UART_RX;`. While building that, I noticed the PICO_PLATFORM wasn't matching:
![[Screenshot from 2025-08-04 14-46-11.png|600]]

I tried both `-DPICO_PLATFORM=rp2350-riscv` and `-DPICO_PLATFORM=rp2350-arm-s`, and both options worked for the simple demo. However, this fix didn't work for the memory controller. Whenever I tried putting the uf2 file on the device, the device would rebbot as then appear again in bootloader mode, even though nothing is connected to the BT pin and I wasn't holding down the button when the device restarted.

I messaged the devs again asking for advice on which flag to use and ensuring the firmware actually gets programmed.
### Documentation
I rewrote the README for the repo and updated the state diagram:
![[Memory Controller FSM.pdf]]

## Next
- BRAM/SPRAM Demo
	- Figure out why SPRAM isn't working on the pico2 or with explicit BRAM
	- Update verilog documentation
	- Figure out how to time read + writes from the Pi

[[2025-08-01|prev]] [[2025-08-05|next]]
