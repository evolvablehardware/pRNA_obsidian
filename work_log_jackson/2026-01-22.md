## Log
- I've been messing around with different fitness functions for using multiple devices. I've had good luck so far with this one:
	- $$\frac{ \frac {1} {MSE(expected, actual)}} {1 + \sum max(|p-mean(P)| - 0.03*expected, 0)^2}$$
	- MSE used since I'm not really sure how the current fitness function works and I wanted to ensure that if one of the evaluations was bad, it would have a bad fitness overall. Inverse taken since bitstreamevolution uses fitness instead of loss.
	- When I initially messed around with variance I didn't have the +1, which created an asymptote  around minimizing variance. This worked well initially but after about 35khz it was too hard to improve while keeping circuits nearly identical. This fixes that oversight
	- I added a tolerance to the variance as some amount of noise is to be expected, and I think without it the population diversity would crash. I have not yet done a run without the tolerance. The idea behind this is that it keeps circuits from using too much undefined behavior that is inconsistent across devices.
	 - Experiment was cut short with the reservation issue, got to epoch ~25. Best circuit had all 3 devices within about 1k pulses of 40khz.
	 - I'm considering at some point adding extra punishment for when some evaluations are over the target while some are under
- I had the reservation issue occur again, having since enabled additional logging. It looks like the control server is indeed falsely sending a reservation end event under some condition. 
	- The control eventsender flushed 2 events to the serial that was incorrectly ended. One of them was the ending soon notification, but the other remains unaccounted for; presumably the reservation end notification. No other logging mentions the second event.
	- I suspect that the reservation end was coming from the postgres LISTEN/NOTIFY rather than the reservation polling. My logging was improperly placed which allowed this to go through unnoticed
	- I moved some logging around and added more. I think that the reservation end trigger has a false positive and as a result removes the device. I'm not sure how this would occur though.
## Next
- Experiment with starting from a non 1khz clock seed. I suspect that with ALL routing this will be now possible. I'm not yet sure what to do to guarantee IO tile routing behaves nicely. 
- I wonder there is room for innovation on our crossover methods. Considering the diversity is usually rather low, it would be interesting to see if selecting a circuit with higher than target and one with lower than target would work well.
- We might want to consider a mutation rate decay as we reach higher fitness levels

[[work_log_jackson/2026-01-21|prev]] [[work_log_jackson/2026-01-23|next]]
