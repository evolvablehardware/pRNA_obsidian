# Log
- What example firmware can we use baud to bootloader? 
	- rp2_blinky: no dev file
	- rp2_blinky_cplusplus: no dev file
	- rp2_cram : no dev file
	- rp2_fpga: no dev file
	- rp2_ice_blinky: no dev file
	- rp2_usb_uf2: no dev file (sda)
	
	- rp2_flash : works (default config)
	- rp2_flash_repl: works (default config)
	- rp2_hello_world: works (default config)
	- rp2_usb_fpga : works
		- If I add a printf, I am able to receive it
	- rp2_usb_uart: works
		- If I add a printf, I am not able to receive it
	
- rp2_usb_fpga seems like a good candidate for building evaluation firmware off of. We actually know what the config is, stdio works, and the bootloader functionality works. 
	- I was able to get inputs working in addition to the setup output
	- All we really need to do is to get the tinyuf2 working, which I have been able to on the uart firmware, I am hopeful that I will be able to again. 
		- There's also a second unneeded uart interface which is unneeded... so this functionally should be removed but its not necessary  
			- I was able to remove this but broke the bootloader functionality in the process. The stdio still works fine though. 
			- The rp_hello_world uses only one dev, so this should be possible. **Having a second unresponsive device would be really annoying to deal with once we are connecting multiple devices**
				- we can filter based on the usb interface num using udevadm. kinda hacky though. 
			
	- I got a working firmware that has the uf2 upload functionality and mirrors back all inputs it receives from stdin. It also works with the baud of 1200 to enter the bootloader. I'm pretty confident we can use this as a base for running experiments.
		- Based on the example rp2_usb_uart, we could instead directly communicate between the ice40 and the host computer. We might want to consider doing this instead? Otherwise, we can use the gpio pico-sdk functions to do pin stuff.
		- **We need to figure a way to know when to start measuring for fpga fitness if we use the uf2 functionally**
			- I think exposing the uf2 is probably significantly faster than if we were to send the bitstream over stdio? It might be worth doing some benchmarks on this. If using stdio is a similar speed, it might be better to send it over to the pico and program it from there. While uf2 is really convenient to program the chip, the pico has no way of knowing (?).
				- If the serial protocol finishes when the fpga is restarted, we could send a command to start measuring fitness. However, I think it's more likely that the bitstream is put into the picos ram, the transfer is considered complete, and then it is uploaded to the fpga. 
## Next
- I still don't know why the rp_usb_uart example does not work with stdio or baud. However, we now have a firmware with the necessary usb stuff set up for experiments. I think that the only thing standing in the way of writing evaluation firmware is learning about the picos gpio apis for measuring the output of the ice40. 
- Now that we have firmware that implements both entering the boot loader through baud and programming the ice40 through uf2, I feel a lot more confident about moving forward with the usbip project. 
	- Experimenting with tinyusb has definitely helped with the scope of the project. I need to handle the possibility of having multiple dev files for one device, and provide the tools for selecting the correct one to connect to. This extra flexibility would allow firmware to be flashed without needing additional tooling. I think I still will provide the option though, its a pretty common operation and it would still be annoying to do over usbip since the user would have to poll the api to see when the bootloader device becomes available. 

[[work_log_jackson/2025-09-25|prev]] [[work_log_jackson/2025-09-29|next]]
